<html>
<head>
<script type=text/javascript src=js/func.js?001></script>
<script type=text/javascript src=js/canvasjs.js?001></script>
<script type=text/javascript>
function loadData(){
  var d = new Date();
  var sd = d.getUTCFullYear() + '-' + (d.getUTCMonth() + 1) + '-' + d.getUTCDate() + ' ' +  d.getUTCHours() + ':' + d.getUTCMinutes() + ':' + d.getUTCSeconds();
  var js = document.createElement('script');
  js.type='text/javascript';
  js.src="kpi.js" + "?d=" + sd;
  js.onload = function(){ 
    gfx01.options.data[0].dataPoints=gfx01_d1;
    gfx01.options.data[1].dataPoints=gfx01_d2;
    gfx01.render();
    gfx02.options.title.text='QUARTER '+data.q_name; 
    gfx02.options.data[0].dataPoints=[{y:data.q_elapsed}];
    gfx02.options.data[1].dataPoints=[{y:data.q_remaining}];
    gfx02.render();
    gfx03.options.data[0].dataPoints=gfx03_d1;
    gfx03.options.data[1].dataPoints=gfx03_d2;
    gfx03.render();
    gfx04.options.data[0].dataPoints=gfx04_d1;
    gfx04.options.data[1].dataPoints=gfx04_d2;
    gfx04.render();
    gfx05.options.data[0].dataPoints=gfx05_d1;
    gfx05.options.data[1].dataPoints=gfx05_d2;
    gfx05.render();
    }
  document.head.appendChild(js);    
  }

window.onload=function(){
  g01 = new xDiv()
  move(g01,[50,50,450,250]);
  sBrW(g01,[4]);
  sBrC(g01,['#dfe']);
  sBrR(g01,[5]);
  sPar(g01,0);
  gfx01 = new CanvasJS.Chart(g01, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "MACHINING WORKABLE", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Std hours",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  data: [              
    { type: "column", legendText: "Workable", color: "#8b9", showInLegend: true, dataPoints: [] },
    { type: "stackedColumn", legendText: "Overdue", color: "#C44", showInLegend: true, dataPoints: [] }
    ]
  });
  g02 = new xDiv()
  move(g02,[550,50,450,250]);
  sBrW(g02,[4]);
  sBrC(g02,['#dfe']);
  sBrR(g02,[5]);
  sPar(g02,0);
  gfx02 = new CanvasJS.Chart(g02, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "QUARTER", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    interval: null,
    },
  axisY:{
    suffix: "%", interval: 10,
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {enabled: true, content: '<b>{name}</b>: #percent %'},
  data: [              
    { type: "stackedBar100",  showInLegend: true, name: "Elapsed", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    { type: "stackedBar100",  showInLegend: true, name: "Remaining", indexLabelFontColor:'#eee', color:"#ddd", dataPoints: [] },
    ]
  });  
  g03 = new xDiv()
  move(g03,[1050,50,450,250]);
  sBrW(g03,[4]);
  sBrC(g03,['#dfe']);
  sBrR(g03,[5]);
  sPar(g03,0);
  gfx03 = new CanvasJS.Chart(g03, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "TOP 5 WORKCENTERS LOAD", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee",
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    labelFontColor: "#eee",
    labelFontSize: 12,
    },
  axisY:{
    title:"Std hours",titleFontSize:14,
    titleFontColor: "#eee",
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {shared: true},
  data: [              
    { type: "bar",  showInLegend: true, name: "Workable", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    { type: "stackedBar",  showInLegend: true, name: "Overdue", indexLabelFontColor:'#eee', color: "#C44", dataPoints: [] },
    ]
  });  
  g04 = new xDiv()
  move(g04,[1050,350,450,250]);
  sBrW(g04,[4]);
  sBrC(g04,['#dfe']);
  sBrR(g04,[5]);
  sPar(g04,0);
  gfx04 = new CanvasJS.Chart(g04, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "TOP 5 WORKCENTERS LATE", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee",
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    labelFontColor: "#eee",
    labelFontSize: 12,
    },
  axisY:{
    title:"Std hours",titleFontSize:14,
    titleFontColor: "#eee",
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {shared: true},
  data: [              
    { type: "bar",  showInLegend: true, name: "Workable", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    { type: "stackedBar",  showInLegend: true, name: "Overdue", indexLabelFontColor:'#eee', color: "#C44", dataPoints: [] },
    ]
  });  
  g05 = new xDiv()
  move(g05,[550,350,450,250]);
  sBrW(g05,[4]);
  sBrC(g05,['#dfe']);
  sBrR(g05,[5]);
  sPar(g05,0);
  gfx05 = new CanvasJS.Chart(g05, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "MACHINING COMPLETION", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Standard hours",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", lineDashType: "dash", color: "#da0", showInLegend: true, dataPoints: [] },
    { type: "line", name:"Done",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  });
  loadData();  
}
 
</script>
</head>
<body style="background-color:#222">
</body>
</html>
