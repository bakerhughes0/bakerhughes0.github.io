<html>
<head>
<script type=text/javascript src=js/func.js?001></script>
<script type=text/javascript src=js/canvasjs.js?001></script>
<script type=text/javascript>
function loadData(){
  var d = new Date();
  var sd = d.getUTCFullYear() + '-' + (d.getUTCMonth() + 1) + '-' + d.getUTCDate() + ' ' +  d.getUTCHours() + ':' + d.getUTCMinutes() + ':' + d.getUTCSeconds();
  var js = document.createElement('script');
  js.type='text/javascript';
  js.src="kpi.js" + "?d=" + sd;
  js.onload = function(){ 
    gfx01.options.data[0].dataPoints=gfx01_d1;
    gfx01.options.data[1].dataPoints=gfx01_d2;
    gfx02.options.title.text='QUARTER '+data.q_name; 
    gfx02.options.data[0].dataPoints=[{y:data.q_elapsed}];
    gfx02.options.data[1].dataPoints=[{y:data.q_remaining}];
    gfx03.options.data[0].dataPoints=gfx03_d1;
    gfx03.options.data[1].dataPoints=gfx03_d2;
    gfx04.options.data[0].dataPoints=gfx04_d1;
    gfx04.options.data[1].dataPoints=gfx04_d2;
    gfx05.options.data[0].dataPoints=gfx05_d1;
    gfx05.options.data[1].dataPoints=gfx05_d2;
    gfx06.options.data[0].dataPoints=gfx06_d1;
    gfx06.options.data[1].dataPoints=gfx06_d2;
    gfx06.options.data[2].dataPoints=gfx06_d3;
    gfx06.options.data[3].dataPoints=gfx06_d4;
    gfx06.options.data[4].dataPoints=gfx06_d5;
    gfx07.options.data[0].dataPoints=gfx07_d1.reverse();
    gfx08.options.data[0].dataPoints=gfx08_d1;
    gfx08.options.data[1].dataPoints=gfx08_d2;
    gfx08.options.data[2].dataPoints=gfx08_d3;
    gfx08.options.data[3].dataPoints=gfx08_d4;
    gfx08.options.data[4].dataPoints=gfx08_d5;
    gfx09.options.data[0].dataPoints=gfx09_d1;
    gfx09.options.data[1].dataPoints=gfx09_d2;
    gfx09.options.data[2].dataPoints=gfx09_d3;
    gfx09.options.data[3].dataPoints=gfx09_d4;
    gfx09.options.data[4].dataPoints=gfx09_d5;
    gfx10.options.data[0].dataPoints=gfx10_d1;
    gfx10.options.data[1].dataPoints=gfx10_d2;
    gfx10.options.data[2].dataPoints=gfx10_d3;
    gfx10.options.data[3].dataPoints=gfx10_d4;
    gfx10.options.data[4].dataPoints=gfx10_d5;
    gfx11.options.data[0].dataPoints=gfx11_d1;
    gfx11.options.data[1].dataPoints=gfx11_d2;
    gfx11.options.data[2].dataPoints=gfx11_d3;
    gfx11.options.data[3].dataPoints=gfx11_d4;
    gfx11.options.data[4].dataPoints=gfx11_d5;
    gfx12.options.data[0].dataPoints=[{y:45},{y:55},{y:65},{y:118},{y:187},{y:232},{y:278},{y:331},{y:378},{y:429},{y:461},{y:468},{y:475},].slice(0,gfx12_d2.length);
    gfx12.options.data[1].dataPoints=gfx12_d2;
    gfx13.options.data[0].dataPoints=[{y:19},{y:51},{y:73},{y:79},{y:88},{y:89},{y:99},{y:118},{y:132},{y:145},{y:146},{y:152},{y:154},].slice(0,gfx13_d2.length);
    gfx13.options.data[1].dataPoints=gfx13_d2;
    gfx01.render();    
    gfx02.render();
    gfx03.render();
    gfx04.render();
    gfx05.render();
    gfx06.render();
    gfx07.render();
    gfx08.render();
    gfx09.render();
    gfx10.render();
    gfx11.render();
    gfx12.render();
    gfx13.render();
    }
  document.head.appendChild(js);    
  }

window.onload=function(){
  page = new xDiv();
  move(page,[0,0,1920,1080]);
  sBkL(page,100,'#243 30%, #222 100%');
  sPar(page,0);
  
  g01 = new xDiv();	g01.id="g01"
  move(g01,[970,40,450,250]);
  sBrW(g01,[4]);
  sBrC(g01,['#dfe']);
  sBrR(g01,[5]);
  sPar(g01,page);
  gfx01 = new CanvasJS.Chart(g01, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "MACHINING WORKABLE", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Standard hours",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true},
  data: [              
    { type: "column", name: "Workable", color: "#8b9", showInLegend: true, dataPoints: [] },
    { type: "stackedColumn", name: "Overdue", color: "#C44", showInLegend: true, dataPoints: [] }
    ]
  });
  g02 = new xDiv(); g02.id="g02"
  move(g02,[30,40,450,250]);
  sBrW(g02,[4]);
  sBrC(g02,['#dfe']);
  sBrR(g02,[5]);
  sPar(g02,page);
  gfx02 = new CanvasJS.Chart(g02, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "QUARTER", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    interval: null,
    },
  axisY:{
    suffix: "%", interval: 10,
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {enabled: true, content: '<b>{name}</b>: #percent %'},
  data: [              
    { type: "stackedBar100",  showInLegend: true, name: "Elapsed", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    { type: "stackedBar100",  showInLegend: true, name: "Remaining", indexLabelFontColor:'#eee', color:"#ddd", dataPoints: [] },
    ]
  });  
  g03 = new xDiv(); g03.id="g03"
  move(g03,[1440,40,450,250]);
  sBrW(g03,[4]);
  sBrC(g03,['#dfe']);
  sBrR(g03,[5]);
  sPar(g03,page);
  gfx03 = new CanvasJS.Chart(g03, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "TOP 10 WORKCENTERS LOAD", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee",
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    labelFontColor: "#eee",
    labelFontSize: 12,
    interval: 1,
    },
  axisY:{
    title:"Standard hours",titleFontSize:14,
    titleFontColor: "#eee",
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {shared: true},
  data: [              
    { type: "bar", showInLegend: true, name: "Workable", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    { type: "stackedBar",  showInLegend: true, name: "Overdue", indexLabelFontColor:'#eee', color: "#C44", dataPoints: [] },
    ]
  });  
  g04 = new xDiv(); g04.id="g04"
  move(g04,[1440,300,450,250]);
  sBrW(g04,[4]);
  sBrC(g04,['#dfe']);
  sBrR(g04,[5]);
  sPar(g04,page);
  gfx04 = new CanvasJS.Chart(g04, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "TOP 10 WORKCENTERS LATE", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee",
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    labelFontColor: "#eee",
    labelFontSize: 12,
    interval: 1,
    },
  axisY:{
    title:"Standard hours",titleFontSize:14,
    titleFontColor: "#eee",
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {shared: true},
  data: [              
    { type: "bar",  showInLegend: true, name: "Workable", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    { type: "stackedBar",  showInLegend: true, name: "Overdue", indexLabelFontColor:'#eee', color: "#C44", dataPoints: [] },
    ]
  });  
  g05 = new xDiv(); g05.id="g05"
  move(g05,[500,300,450,250]);
  sBrW(g05,[4]);
  sBrC(g05,['#dfe']);
  sBrR(g05,[5]);
  sPar(g05,page);
  gfx05 = new CanvasJS.Chart(g05, {
  animationEnabled: true,
  animationDuration: 1500,
  title: {text: "MACHINING QUARTER TARGET", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Standard hours",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target (7000 h)", lineDashType: "dash", color: "#da0", showInLegend: true, dataPoints: [] },
    { type: "line", name:"Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  });
  g06 = new xDiv(); g06.id="g06"
  move(g06,[500,40,450,250]);
  sBrW(g06,[4]);
  sBrC(g06,['#dfe']);
  sBrR(g06,[5]);
  sPar(g06,page);
  gfx06 = new CanvasJS.Chart(g06, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "MACHINING WEEK COMPLETION", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Standard hours",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8b9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#8b7", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8b5",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#8b3", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8b1",  dataPoints: [] }
    ]
  });  
  g07 = new xDiv(); g07.id="g07"
  move(g07,[970,300,450,250]);
  sBrW(g07,[4]);
  sBrC(g07,['#dfe']);
  sBrR(g07,[5]);
  sPar(g07,page);
  gfx07 = new CanvasJS.Chart(g07, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "TOP 10 MACHINING WORKCENTERS", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee",
    },
  axisX:{
    lineColor:'#ccc', lineThickness: 1,
    labelFontColor: "#eee",
    labelFontSize: 12,
    interval: 1,
    },
  axisY:{
    title:"Quarter Standard hours",titleFontSize:14,
    titleFontColor: "#eee",
    lineColor:'#ccc', lineThickness: 1,
    gridColor:'#ccc', gridThickness: 1,
    labelFontColor: "#eee",
    },
  toolTip: {shared: true},
  data: [              
    { type: "bar", name: "Quarter Completion", indexLabelFontColor:'#eee', color:"#8b9", dataPoints: [] },
    ]
  });  
  g08 = new xDiv(); g08.id="g08"
  move(g08,[30,560,450,250]);
  sBrW(g08,[4]);
  sBrC(g08,['#dfe']);
  sBrR(g08,[5]);
  sPar(g08,page);
  gfx08 = new CanvasJS.Chart(g08, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "PRODUCTION CAMFLEX", fontColor:"#ddd"},
  backgroundColor: "#427057",
  axisY:{
    title: "Quantity",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8b9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#8b7", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8b5",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#8b3", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8b1",  dataPoints: [] }
    ]
  });
g09 = new xDiv(); g09.id="g09"
  move(g09,[500,560,450,250]);
  sBrW(g09,[4]);
  sBrC(g09,['#dfe']);
  sBrR(g09,[5]);
  sPar(g09,page);
  gfx09 = new CanvasJS.Chart(g09, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "PRODUCTION VARIPAK", fontColor:"#ddd"},
  backgroundColor: "#427057",
  axisY:{
    title: "Quantity",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8b9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#8b7", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8b5",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#8b3", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8b1",  dataPoints: [] }
    ]
  });
  g10 = new xDiv(); g10.id="g10"
  move(g10,[970,560,450,250]);
  sBrW(g10,[4]);
  sBrC(g10,['#dfe']);
  sBrR(g10,[5]);
  sPar(g10,page);
  gfx10 = new CanvasJS.Chart(g10, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "PRODUCTION GLOBES", fontColor:"#ddd"},
  backgroundColor: "#427057",
  axisY:{
    title: "Quantity",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8b9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#8b7", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8b5",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#8b3", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8b1",  dataPoints: [] }
    ]
  });
  g11 = new xDiv(); g11.id="g11"
  move(g11,[1440,560,450,250]);
  sBrW(g11,[4]);
  sBrC(g11,['#dfe']);
  sBrR(g11,[5]);
  sPar(g11,page);
  gfx11 = new CanvasJS.Chart(g11, {
  animationEnabled: true,
  animationDuration: 2500,
  title: {text: "PRODUCTION LEVELS", fontColor:"#ddd"},
  backgroundColor: "#427057",
  axisY:{
    title: "Quantity",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8b9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#8b7", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8b5",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#8b3", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8b1",  dataPoints: [] }
    ]
  });
  g12 = new xDiv(); g12.id="g12"
  move(g12,[30,820,450,250]);
  sBrW(g12,[4]);
  sBrC(g12,['#dfe']);
  sBrR(g12,[5]);
  sPar(g12,page);
  gfx12 = new CanvasJS.Chart(g12, {
  animationEnabled: true,
  animationDuration: 1500,
  title: {text: "CAMFLEX QUARTER TARGET", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Quantity",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target", lineDashType: "dash", color: "#da0", showInLegend: true, dataPoints: [] },
    { type: "line", name: "Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  	});
  g13 = new xDiv(); g13.id="g13"
  move(g13,[500,820,450,250]);
  sBrW(g13,[4]);
  sBrC(g13,['#dfe']);
  sBrR(g13,[5]);
  sPar(g13,page);
  gfx13 = new CanvasJS.Chart(g13, {
  animationEnabled: true,
  animationDuration: 1500,
  title: {text: "VARIPAK QUARTER TARGET", fontColor:"#ddd"},
  backgroundColor: "#427057",
  legend: {
    horizontalAlign: "center",
    verticalAlign: "bottom",
    fontSize: 14,
    fontColor: "#eee"
    },
  axisY:{
    title: "Quantity",
    titleFontColor: "#eee",
    labelFontColor: "#eee",
    },
  axisX:{
    labelFontColor: "#eee",
    interval: 1,
    labelAngle: -28,
    },
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target", lineDashType: "dash", color: "#da0", showInLegend: true, dataPoints: [] },
    { type: "line", name: "Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  	});  
  loadData();  
}

function toolTipContent6(e) {
	var str = "";
	var total = 0;
	var str2, str3;
	for (var i = 0; i < e.entries.length; i++){
		var  str1 = "<span style= \"color:"+e.entries[i].dataSeries.color + "\"> "+e.entries[i].dataSeries.name+"</span>: <strong>"+e.entries[i].dataPoint.y+"</strong><br/>";
		total = e.entries[i].dataPoint.y + total;
		str = str.concat(str1);
	  }
	str2 = "<span style = \"color:DodgerBlue;\"><strong>"+(e.entries[0].dataPoint.label)+"</strong></span><br/>";
	total = Math.round(total * 100) / 100;
	str3 = "<span style = \"color:Tomato\">Total:</span><strong> "+total+"</strong><br/>";
	return (str2.concat(str)).concat(str3);
  }  
  
</script>
</head>
<body style="background-color:#243">
</body>
</html>
