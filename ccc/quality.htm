<html>
<head>
<script type=text/javascript src=../js/func.js?001></script>
<script type=text/javascript>



window.onload=function(){
includeFont('fnt1', '../js/fnt1.ttf', 'truetype');  
sBkL(document.body,100,'#243 30%, #222 100%');

function safetyCross(x,y,width){
  var c = new xDiv();
  c.brd=5;
  c.data=[];
  var colB=['#bbb','#2a2','#fa0','#f22'],colF=['#888','#000','#000','#000'];
  var size = (width+c.brd)/8;
  move(c, [x,y,8*size, 14.5*size]);
  sFtN(c,(12*size-1) + 'px/' + (10*size-1) + 'px fnt1');sFtA(c, 'center');
  sFtC(c,'#163');sOpa(c,.85);
  c.o=[];
  c.t=[];c.l=[];
  tw = size*3;th = size*.85;sx=size+c.brd
  for (n=0; n<31; n++) {
    c.t[n] = new xDiv(); sPar(c.t[n], c); sBrW(c.t[n],[1]);sBrR(c.t[n],[8]); sBrC(c.t[n],['#ddd']); sBkC(c.t[n],'rgba(0,0,0,0');sOpa(c.t[n],0.1)
    sFtN(c.t[n],'bold '+th/2.6+'px Calibri'); 
    c.l[n] = new xLng(); sPar(c.l[n], c); sBrC(c.l[n],['#eee']); sBrW(c.l[n],[2,0,0,0]);
    }
  move(c.t[0],[10*size,6*size,tw,th]); 
  move(c.t[1],[10*size,5*size,tw,th]);
  move(c.t[2],[10*size,4*size,tw,th]);
  move(c.t[3],[10*size,3*size,tw,th]);
  move(c.t[4],[10*size,2*size,tw,th]);
  move(c.t[5],[10*size,1*size,tw,th]);
  move(c.t[6],[10*size,0*size,tw,th]);
  move(c.t[7],[9*size,-1*size,tw,th]);
  move(c.t[8],[8*size,-2*size,tw,th]);
  move(c.t[9],[6*size,-3*size,tw,th]);
  move(c.t[10],[0*size,-3*size,tw,th]);
  move(c.t[11],[-2*size,-2*size,tw,th]);
  move(c.t[12],[-3*size,-1*size,tw,th]);
  move(c.t[13],[-4*size,0*size,tw,th]);
  move(c.t[14],[-4*size,1*size,tw,th]);
  move(c.t[15],[-4*size,2*size,tw,th]);
  move(c.t[16],[-4*size,3*size,tw,th]);
  move(c.t[17],[-4*size,4*size,tw,th]);
  move(c.t[18],[-4*size,5*size,tw,th]);
  move(c.t[19],[-4*size,6*size,tw,th]);
  move(c.t[20],[-4*size,7*size,tw,th]);
  move(c.t[21],[-3*size,8*size,tw,th]);
  move(c.t[22],[-2*size,9*size,tw,th]);
  move(c.t[23],[0*size,10*size,tw,th]);
  move(c.t[24],[5*size,11*size,tw,th]);
  move(c.t[25],[9*size,11*size,tw,th]);
  move(c.t[26],[9*size,10*size,tw,th]);
  move(c.t[27],[2*size,6*size,tw,th]);
  move(c.t[28],[10*size,7*size,tw,th]);
  move(c.t[29],[10*size,8*size,tw,th]);
  move(c.t[30],[10*size,9*size,tw,th]);

  for (n=0; n<31; n++) {
    c.o[n] = new xDiv();
    sBrW(c.o[n],[1]);sBrR(c.o[n], [size/2.5]);sBrC(c.o[n],['#aaa']);
    sPar(c.o[n], c);  
    }
  c.setdata= function(d){
    c.data=d;
    var x1=x, y1=y;
    if(c.data.length<31) y1+=size/2;
    ang=-.6;
    var diam=4.5*size;
    for (n=1; n<32; n++) {
      if(n<28){

      }else{
        ang=-.86+(n-29)*.05;
        diam=4.5*size+(n-29)*size*.96;
        }
      x1=4*size+diam*Math.cos(ang);
      y1=4*size-diam*Math.sin(ang);

      move(c.o[n-1],[x1,y1,size-c.brd,size-c.brd]);
      if(n<=c.data.length){
        sOpa(c.o[n-1],.9)
        sBkC(c.o[n-1],'#eee');
        if(c.data[n-1]==undefined){ 
          sBkC(c.o[n-1],colB[0]); sFtC(c.o[n-1],colF[0]); 
          }else if(c.data[n-1]==0){sBkC(c.o[n-1],'#eee'); sFtC(c.o[n-1],'#000');
        }else{
          sBkC(c.o[n-1],colB[c.data[n-1]]); sFtC(c.o[n-1],colF[c.data[n-1]]);
          }
      }else{
        sOpa(c.o[n-1],0);sBkC(c.o[n-1],colB[0]); sFtC(c.o[n-1],colF[0]);      
        }
      sFtN(c.o[n-1],(.5*size-1) + 'px/' + (size-c.brd-1) + 'px fnt1');
      sFtA(c.o[n-1], 'center');
      sTxt(c.o[n-1], n.toString());
      ang+=2*Math.PI/28.25;
      if(gPos(c.t[n-1])[0]<size*4){
        c.l[n-1].draw( [  gPos(c.t[n-1])[0]+tw, gPos(c.t[n-1])[1]+th/2, gPos(c.o[n-1])[0]+size/2, gPos(c.o[n-1])[1]+size/2   ]) ;
        }else{
        c.l[n-1].draw( [  gPos(c.t[n-1])[0], gPos(c.t[n-1])[1]+th/2, gPos(c.o[n-1])[0]+size/2, gPos(c.o[n-1])[1]+size/2   ]) ;
        }
      }
    }
  c.settext=function(arr){
    for(var n=0;n<31;n++){sOpa(c.t[n],0.1);sOpa(c.l[n],0);sBkC(c.t[n],'rgba(0,0,0,0');}
    for(var n=0;n<arr.length;n++){
      if(arr[n]!=undefined){
      if(arr[n].length>0){
        sTxt(c.t[n],arr[n]);
        sOpa(c.t[n],1);sOpa(c.l[n],1);
        sBkC(c.t[n],'#ccc');
        }
        }
      }
    }

  var leg = new xDiv();sPar(leg,c);sBrW(leg,[1]);move(leg,[0,14*th,th*10,th*2.4]);
  var legTxt=['Jour non-travaillé','Aucune non-conformité','une non-conformité','Plusieures non-conformités']
  for(var n=0;n<4;n++){
    var b=new xDiv();sPar(b,leg);sBkC(b,colB[n]);move(b,[.2*th,n*th*.5+.2*th,th*.4,th*.4]);sBrC(b,['#eee']);sBrW(b,[1]);
    var t=new xLab();sPar(t,leg);move(t,[th*.8,n*th*.5+.2*th,th*9,th*.4]);sTxt(t,legTxt[n]);sFtA(t,'left');sFtC(t,'#eee');
    }
  return c;
  }

var tit=new xLab();sPar(tit,0);sFtC(tit,'#eee');move(tit,[10,10,800,30]);

function loaddata(){
  var d = new Date();
  var sd = d.getUTCFullYear() + '-' + (d.getUTCMonth() + 1) + '-' + d.getUTCDate() + ' ' +  d.getUTCHours() + ':' + d.getUTCMinutes() + ':' + d.getUTCSeconds();
  var js = document.createElement('script');
  js.type='text/javascript';
  js.src="data.js" + "?d=" + sd;
  js.onload = function(){ 
    var dep=qs('dep');
    if(dep=='usinage'){
      sTxt(tit, 'CCC Usinage - Point Qualité');
      croix.setdata(qua_usi)
      croix.settext(qua_usi_txt)
      }
    else if(dep=='peinture'){
      sTxt(tit, 'CCC Peinture - Point Qualité');
      croix.setdata(qua_pnt)
      croix.settext(qua_pnt_txt)
      }
    else if(dep=='picking'){
      sTxt(tit, 'CCC Picking - Point Qualité');
      croix.setdata(qua_pic)
      croix.settext(qua_pic_txt)
      }
    else if(dep=='standard'){
      sTxt(tit, 'CCC Assemblage Standard - Point Qualité');
      croix.setdata(qua_std)
      croix.settext(qua_std_txt)
      }
    else if(dep=='conventionnel'){
      sTxt(tit, 'CCC Assemblage Conventionnel - Point Qualité');
      croix.setdata(qua_con)
      croix.settext(qua_con_txt)
      }
    }
  document.head.appendChild(js);    
  };

var croix=new safetyCross(10,10,scrH()*.44);
loaddata();
setTimeout(function(){sPar(croix,0);},1);

window.onresize=function(){cScr(croix);var p = gPos(croix);p[1]+=th*2;sPos(croix,p);} 
window.onresize();  
  
  
  
  }

function qs(variable) {
  var vars = window.location.search.substring(1).toLowerCase().split('&');
  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');
    if (decodeURIComponent(pair[0]) == variable) return decodeURIComponent(pair[1]);
    }
  }
</script>
</head>
<body>
</body>
</html>