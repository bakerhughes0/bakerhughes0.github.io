<html>
<head>
<script type=text/javascript src=js/func.js?001></script>
<script type=text/javascript src=js/canvasjs.min.js?007></script>
<script type=text/javascript src=module.js?001></script>
<script type=text/javascript>

function loadData(){
  var d = new Date();
  var sd = d.getUTCFullYear() + '-' + (d.getUTCMonth() + 1) + '-' + d.getUTCDate() + ' ' +  d.getUTCHours() + ':' + d.getUTCMinutes() + ':' + d.getUTCSeconds();
  var js = document.createElement('script');
  js.type='text/javascript';
  js.src="kpi.js" + "?d=" + sd;
  document.head.appendChild(js);    
  js.onload = function(){ 
    gfx08.options.data[0].dataPoints=gfx08_d1;
    gfx08.options.data[1].dataPoints=gfx08_d2;
    gfx08.options.data[2].dataPoints=gfx08_d3;
    gfx08.options.data[3].dataPoints=gfx08_d4;
    gfx08.options.data[4].dataPoints=gfx08_d5;
    gfx08.options.data[5].dataPoints=[{y:42, caption:'toto'},{y:42},{y:44},{y:54},{y:47},{y:42},{y:32},{y:49},{y:38},{y:38},{y:36},{y:39},{y:21},].slice(0,gfx08_d4.length+3);
    gfx08.render();
    gfx09.options.data[0].dataPoints=gfx09_d1;
    gfx09.options.data[1].dataPoints=gfx09_d2;
    gfx09.options.data[2].dataPoints=gfx09_d3;
    gfx09.options.data[3].dataPoints=gfx09_d4;
    gfx09.options.data[4].dataPoints=gfx09_d5;
    gfx09.options.data[5].dataPoints=[{label:'23W14',y:6},{label:'23W15',y:4},{label:'23W16',y:7},{label:'23W17',y:10},{label:'23W18',y:8},{label:'23W19',y:6},{label:'23W20',y:7},{label:'23W21',y:9},{label:'23W22',y:2},{label:'23W23',y:7},{label:'23W24',y:6},{label:'23W25',y:8},{label:'23W26',y:7},].slice(0,gfx09_d4.length+3);
    gfx09.render();
    gfx10.options.data[0].dataPoints=gfx10_d1;
    gfx10.options.data[1].dataPoints=gfx10_d2;
    gfx10.options.data[2].dataPoints=gfx10_d3;
    gfx10.options.data[3].dataPoints=gfx10_d4;
    gfx10.options.data[4].dataPoints=gfx10_d5;
    gfx10.options.data[5].dataPoints=[{label:'23W14',y:9},{label:'23W15',y:5},{label:'23W16',y:10},{label:'23W17',y:8},{label:'23W18',y:9},{label:'23W19',y:9},{label:'23W20',y:7},{label:'23W21',y:9},{label:'23W22',y:9},{label:'23W23',y:11},{label:'23W24',y:11},{label:'23W25',y:8},{label:'23W26',y:5},].slice(0,gfx10_d4.length+3);
    gfx10.render();
    gfx11.options.data[0].dataPoints=gfx11_d1;
    gfx11.options.data[1].dataPoints=gfx11_d2;
    gfx11.options.data[2].dataPoints=gfx11_d3;
    gfx11.options.data[3].dataPoints=gfx11_d4;
    gfx11.options.data[4].dataPoints=gfx11_d5;
    gfx11.options.data[5].dataPoints=[{label:'23W14',y:12},{label:'23W15',y:8},{label:'23W16',y:13},{label:'23W17',y:17},{label:'23W18',y:18},{label:'23W19',y:18},{label:'23W20',y:10},{label:'23W21',y:20},{label:'23W22',y:15},{label:'23W23',y:12},{label:'23W24',y:14},{label:'23W25',y:15},{label:'23W26',y:14},].slice(0,gfx11_d4.length+3);
    gfx11.render();
    gfx12.options.data[0].dataPoints=[{label:'23W14',y:42},{label:'23W15',y:84},{label:'23W16',y:128},{label:'23W17',y:182},{label:'23W18',y:229},{label:'23W19',y:271},{label:'23W20',y:303},{label:'23W21',y:352},{label:'23W22',y:390},{label:'23W23',y:428},{label:'23W24',y:464},{label:'23W25',y:503},{label:'23W26',y:524},].slice(0,gfx12_d2.length+3);
    gfx12.options.data[1].dataPoints=gfx12_d2;
    gfx12.render();
    gfx13.options.data[0].dataPoints=[{label:'23W14',y:6},{label:'23W15',y:10},{label:'23W16',y:17},{label:'23W17',y:27},{label:'23W18',y:35},{label:'23W19',y:41},{label:'23W20',y:48},{label:'23W21',y:57},{label:'23W22',y:59},{label:'23W23',y:66},{label:'23W24',y:72},{label:'23W25',y:80},{label:'23W26',y:87},].slice(0,gfx13_d2.length+3);
    gfx13.options.data[1].dataPoints=gfx13_d2;
    gfx13.render();
    gfx14.options.data[0].dataPoints=[{label:'23W14',y:9},{label:'23W15',y:14},{label:'23W16',y:24},{label:'23W17',y:32},{label:'23W18',y:41},{label:'23W19',y:50},{label:'23W20',y:57},{label:'23W21',y:66},{label:'23W22',y:75},{label:'23W23',y:86},{label:'23W24',y:97},{label:'23W25',y:105},{label:'23W26',y:110},].slice(0,gfx14_d2.length+3);
    gfx14.options.data[1].dataPoints=gfx14_d2;
    gfx14.render();
    gfx15.options.data[0].dataPoints=[{label:'23W14',y:12},{label:'23W15',y:20},{label:'23W16',y:33},{label:'23W17',y:50},{label:'23W18',y:68},{label:'23W19',y:86},{label:'23W20',y:96},{label:'23W21',y:116},{label:'23W22',y:131},{label:'23W23',y:143},{label:'23W24',y:157},{label:'23W25',y:172},{label:'23W26',y:186},].slice(0,gfx15_d2.length+3);
    gfx15.options.data[1].dataPoints=gfx15_d2;
    gfx15.render();
    gfx16.options.data[0].dataPoints=[{label:'18Q1', y:470},{label:'18Q2', y:474},{label:'18Q3', y:425},{label:'18Q4', y:540},{label:'19Q1', y:727},{label:'19Q2', y:558},{label:'19Q3', y:588},{label:'19Q4', y:778},{label:'20Q1', y:837},{label:'20Q2', y:596},{label:'20Q3', y:677},{label:'20Q4', y:519},{label:'21Q1', y:423},{label:'21Q2', y:501},{label:'21Q3', y:606},{label:'21Q4', y:679},{label:'22Q1', y:572},{label:'22Q2', y:445},{label:'22Q3', y:532},{label:'22Q4', y:496},{label:'23Q1', y:524},{name:"Target",color:"#cc6",label:'23Q2', y:524}];
    gfx16.render();
    gfx17.options.data[0].dataPoints=[{label:'18Q1',y:189},{label:'18Q2',y:139},{label:'18Q3',y:133},{label:'18Q4',y:132},{label:'19Q1',y:138},{label:'19Q2',y:204},{label:'19Q3',y:181},{label:'19Q4',y:184},{label:'20Q1',y:211},{label:'20Q2',y:200},{label:'20Q3',y:281},{label:'20Q4',y:209},{label:'21Q1',y:254},{label:'21Q2',y:233},{label:'21Q3',y:163},{label:'21Q4',y:188},{label:'22Q1',y:126},{label:'22Q2',y:93},{label:'22Q3',y:136},{label:'22Q4',y:179},{label:'23Q1',y:170},{name:"Target",color:"#cc6",label:'23Q2', y:87}];
    gfx17.render();
    gfx18.options.data[0].dataPoints=[{label:'18Q1',y:592},{label:'18Q2',y:365},{label:'18Q3',y:295},{label:'18Q4',y:368},{label:'19Q1',y:364},{label:'19Q2',y:207},{label:'19Q3',y:321},{label:'19Q4',y:286},{label:'20Q1',y:543},{label:'20Q2',y:331},{label:'20Q3',y:359},{label:'20Q4',y:310},{label:'21Q1',y:212},{label:'21Q2',y:319},{label:'21Q3',y:469},{label:'21Q4',y:468},{label:'22Q1',y:408},{label:'22Q2',y:287},{label:'22Q3',y:141},{label:'22Q4',y:157},{label:'23Q1',y:142},{name:"Target",color:"#cc6",label:'23Q2', y:110}];
    gfx18.render();
    gfx19.options.data[0].dataPoints=[{label:'18Q1',y:320},{label:'18Q2',y:253},{label:'18Q3',y:246},{label:'18Q4',y:312},{label:'19Q1',y:272},{label:'19Q2',y:200},{label:'19Q3',y:603},{label:'19Q4',y:338},{label:'20Q1',y:212},{label:'20Q2',y:286},{label:'20Q3',y:248},{label:'20Q4',y:188},{label:'21Q1',y:312},{label:'21Q2',y:186},{label:'21Q3',y:184},{label:'21Q4',y:147},{label:'22Q1',y:152},{label:'22Q2',y:202},{label:'22Q3',y:172},{label:'22Q4',y:140},{label:'23Q1',y:209},{name:"Target",color:"#cc6",label:'23Q2', y:186}];
    gfx19.render();
    sTxt(timstp,'Update : ' + tm);
    }
  }

window.onload=function(){
  var bg = new background();
  t1=new xLab();sFtC(t1,'#ccc');sPar(t1,0);
  t2=new xLab();sFtC(t2,'#ccc');sPar(t2,0);sFtA(t2,'right');
  sTxt(t1,"CONDE MATERIALS KPI - PRODUCTION CONTROL");
  sTxt(t2,"ASSEMBLY PRODUCTION");
  timstp=new xLab();sPar(timstp,main);sFtC(timstp,'#666');
  var g = [];
  for(var n=0; n<12; n++){g[n] = new gfxbox();}

  var axeY_1 = {title: "Quantity", titleFontColor: "#eee", labelFontColor: "#eee", labelFontFamily: 'Arial', minimum:0}
  var axeX_1 = {labelFontColor: "#eee", interval: 1, labelAngle: -32, labelFontFamily: 'Arial'}
  var axeX_2 = {labelFontColor: "#eee", interval: 1, labelAngle: -66, labelFontFamily: 'Arial', labelFontSize: 10}
  var leg_1 = {horizontalAlign: "center", verticalAlign: "bottom", labelFontFamily: 'Arial', fontColor: "#eee"}

  gfx08 = new CanvasJS.Chart(g[0], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "CAMFLEX WEEK PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend:leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8B9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8B9",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8B9",  dataPoints: [] },
    { type: "line", name:"Target",lineDashType:"dash",color: "#CC6",showInLegend:true,dataPoints:[]},
    ]
  });
  gfx09 = new CanvasJS.Chart(g[1], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "VARIPAK WEEK PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend:leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8B9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8B9",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8B9",  dataPoints: [] },
    { type: "line", name:"Target",lineDashType:"dash",color: "#CC6",showInLegend:true,dataPoints:[]},
    ]
  });
  gfx10 = new CanvasJS.Chart(g[2], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "GLOBES WEEK PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend:leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8B9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8B9",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8B9",  dataPoints: [] },
    { type: "line", name:"Target",lineDashType:"dash",color: "#CC6",showInLegend:true,dataPoints:[]},
    ]
  });
  gfx11 = new CanvasJS.Chart(g[3], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "LEVELS WEEK PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend:leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true, content: toolTipContent6},
  data: [              
    { type: "stackedColumn", name: "Mon", color: "#8B9", dataPoints: [] },
    { type: "stackedColumn", name: "Tue", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Wed", color: "#8B9",  dataPoints: [] },
    { type: "stackedColumn", name: "Thu", color: "#586", dataPoints: [] },
    { type: "stackedColumn", name: "Fri", color: "#8B9",  dataPoints: [] },
    { type: "line", name:"Target",lineDashType:"dash",color: "#CC6",showInLegend:true,dataPoints:[]},
    ]
  });

  gfx12 = new CanvasJS.Chart(g[4], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "CAMFLEX QUARTER TARGET", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend: leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target", lineDashType: "dash", color: "#CC6", showInLegend: true, dataPoints: [] },
    { type: "line", name: "Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  });
  gfx13 = new CanvasJS.Chart(g[5], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "VARIPAK QUARTER TARGET", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend: leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target", lineDashType: "dash", color: "#CC6", showInLegend: true, dataPoints: [] },
    { type: "line", name: "Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  });
  gfx14 = new CanvasJS.Chart(g[6], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "GLOBES QUARTER TARGET", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend: leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target", lineDashType: "dash", color: "#CC6", showInLegend: true, dataPoints: [] },
    { type: "line", name: "Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  });  
  gfx15 = new CanvasJS.Chart(g[7], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "LEVELS QUARTER TARGET", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  legend: leg_1,
  axisY:axeY_1,
  axisX:axeX_1,
  toolTip: {shared: true},
  data: [              
    { type: "line", name: "Target", legendText: "Target", lineDashType: "dash", color: "#CC6", showInLegend: true, dataPoints: [] },
    { type: "line", name: "Completed",  color:"#8b9", showInLegend: true, dataPoints: [] }
    ]
  });

  gfx16 = new CanvasJS.Chart(g[8], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "CAMFLEX QUARTER PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  axisY:axeY_1,
  axisX:axeX_2,
  toolTip: {shared: true},
  data: [              
    { type: "column", name: "Completed",  color:"#8b9", dataPoints: [] },
    ]
  }); 
  gfx17 = new CanvasJS.Chart(g[9], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "VARIPAK QUARTER PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  axisY:axeY_1,
  axisX:axeX_2,
  toolTip: {shared: true},
  data: [              
    { type: "column", name: "Completed",  color:"#8b9", dataPoints: [] },
     ]
  }); 
  gfx18 = new CanvasJS.Chart(g[10], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "GLOBES QUARTER PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  axisY:axeY_1,
  axisX:axeX_2,
  toolTip: {shared: true},
  data: [              
    { type: "column", name: "Completed",  color:"#8b9", dataPoints: [] },
     ]
  });
  gfx19 = new CanvasJS.Chart(g[11], {
  animationEnabled: true,
  animationDuration: 500,
  title: {text: "LEVELS QUARTER PRODUCTION", fontColor:"#ddd",fontFamily: 'Arial'},
  backgroundColor: null,
  axisY:axeY_1,
  axisX:axeX_2,
  toolTip: {shared: true},
  data: [              
    { type: "column", name: "Completed",  color:"#8b9", dataPoints: [] },
     ]
  });

  window.onresize=function(){
    movep(bg,[0,0,1,1]);
    movep(t1,[.01, .01, .98, .045]);
    movep(t2,[.01, .01, .98, .045]);
    movep(timstp,[.01, .97, 1, .03]);
    for(var n=0; n<12; n++){
      x = n % 4;
      y = Math.floor(n/4);
      movep(g[n],[.01+x*.2475, .07+y*.3, .2375, .29]);
      }
    };window.onresize();

  loadData();
  }
</script>
</head>
<body >
</body>
</html>